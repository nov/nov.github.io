title: OpenID Authentication 2.0 - Final（日本語訳）
abstract: |
  OpenID 認証は、エンドユーザが識別子（Identifier）を管理していることを証明する方法を提供するものである。 OpenID 認証を利用すれば、リライングパーティー（Relying Party 、以下 RP）はエンドユーザのパスワードなどのクレデンシャルやEメールアドレスなどの機密情報にアクセスする必要がなくなる。
  OpenID は、分散方式であり、 RP や OpenID プロバイダ（OpenID Provider 、以下 OP）の承認・登録を行なう中央集権的な機関は不要である。エンドユーザは利用する OP を自由に選択することができ、 OPを変更しても自身の識別子をそのまま継続して利用することができる。
  プロトコルの動作には JavaScript や最新ブラウザは全く必要がなく、また AJAX を利用しても、認証（authentication）の仕組みは上手く機能する。つまり、エンドユーザは、現在のウェブページから離れずに、 RP に自らの身元を証明できるのである。
  OpenID 認証は、 HTTP（S）の標準的な要求／応答だけを用いているため、ユーザエージェント（User-Agent）などのクライアントソフトウェアが特別な機能を備えている必要はない。 OpenID は、 cookie をはじめ、 RP や OP 特有のセッション管理方法には全く依存していない。 ユーザエージェントの機能拡張により、エンドユーザの操作を簡素化できるが、プロトコル利用上は必ずしも必要ではない。
  プロファイル情報の交換や、本仕様に記されていないその他の情報の交換については、本プロトコル上にサービスタイプを追加し、仕組みを構築することで実現可能である。 OpenID 認証は、ポータブル（環境に依存せずに使用可能）でユーザセントリックなデジタルアイデンティティを、自由かつ分散的な方式で実現するための基盤サービスを提供するために設計された。
sections:
  section_1:
    title: 要求記法および規則
    content: |
      本文書で用いられる各キーワード「しなければならない（MUST）」、「してはならない（MUST NOT）」、「必須である（REQUIRED）」、「するものとする（SHALL）」、「しないものとする（SHALL NOT）」、「すべきである（SHOULD）」、「すべきではない（SHOULD NOT）」、「推奨される（RECOMMENDED）」、「してもよい（MAY）」、「任意である（OPTIONAL）」は、 [RFC2119] で述べられている通りに解釈されるべきものである。
      本文書では、書いてあるままに解釈されるべき値は引用符（""）で囲んで示している。プロトコルメッセージの中でこれらの値を使用する場合は、値の一部として引用符を用いてはならない（MUST NOT）。
  section_2:
    title: 用語
    content:
      dl:
        dt: 識別子（Identifier）
        dd: 識別子は、 "http" または "https" URI（本文書では、通例に従い "URL" と表記）、もしくは XRI [XRI_Syntax_2.0] のいずれかである。本文書では、様々な種類の識別子を定義するが、それぞれ異なるコンテキストでの使用を目的としている。
        dt: ユーザエージェント（User-Agent）
        dd: HTTP/1.1 [RFC2616] を実装したエンドユーザのウェブブラウザ。
        dt: リライングパーティー（Relying Party）
        dd: 略語は RP 。エンドユーザが識別子を管理しているという証明を要求するウェブアプリケーション。
        dt: OpenIDプロバイダ（OpenID Provider）
        dd: 略語はOP。エンドユーザが識別子を管理しているというアサーション (assertion) を得るためにRPが依存する OpenID 認証サーバ。
        dt: OPエンドポイントURL（OP Endpoint URL）
        dd: OpenID 認証プロトコルメッセージを受け入れる URL で、 ユーザ入力識別子(User-Supplied Identifier) のディスカバリ (discovery) を実行することにより得られる。この値は、絶対 HTTP または HTTPS URL でなければならない (MUST) 。
        dt: OP識別子 (OP Identifier)
        dd: OpenID プロバイダの識別子。
        dt: ユーザ入力識別子 (User-Supplied Identifier)
        dd: エンドユーザが RP に提示する識別子、または OP においてユーザが選択した識別子。プロトコルの開始 (initiation) フェーズでは、エンドユーザは、自らの識別子、OP 識別子 （OP Identifier） のどちらを入力してもよい。 OP 識別子を用いる場合、 OP は、エンドユーザが RP に提示する識別子の選択を支援してもよい。
        dt: 主張識別子 (Claimed Identifier)
        dd: |
          エンドユーザが自らのものであると主張する識別子。プロトコル全体の狙いは、この主張を検証することにある。主張識別子は、以下のいずれかである。
          ul:
            li: URL の場合、ユーザ入力識別子を正規化することで得られる識別子。
            li: XRI の場合、正準化 ID (CanonicalID） 。
        dt: OP ローカル識別子 (OP-Local Identifier)
        dd: 特定の OP でエンドユーザを識別するためにローカルに用いられる代替の識別子。そのため、必ずしもエンドユーザが管理しているものではない。
  section_3:
    title: プロトコルの概要
    content:
      ol:
        li: エンドユーザは、ユーザエージェントを通じて RP にユーザ入力識別子を提示することによって、認証を開始する。
        li: ユーザ入力識別子を正規化した後、 RP はそのディスカバリを実行し、エンドユーザが認証に用いる OP エンドポイントURLを確定する。ユーザ入力識別子は、 OP 識別子である可能性があることに留意する必要があるが、この点についてはセクション 7.3.1 で述べる。  OP 識別子のときは、 OP で主張識別子を選択することができる。また、拡張仕様を利用して実用的な代替手段が取られている場合は、主張識別子を用いずにプロトコルを続行することもできる。
        li: 	(オプション) RP と OP の間にアソシエーション （association） を確立する。 共有秘密鍵の確立には、 Diffie-Hellman 鍵交換 [RFC2631] を用いる。OPはその後のメッセージに署名するためにアソシエーションを用い、 RP はこれらのメッセージを検証するためにアソシエーションを用いる。その結果、それぞれの認証要求／応答に続く署名検証のための直接要求を行なう必要がなくなる。
        li: RP は、エンドユーザのユーザエージェントを、 OpenID 認証要求とともに OP にリダイレクトする。
        li: OP は、エンドユーザが OpenID 認証の実行を許可されているかどうか、さらにエンドユーザが認証の実行を求めているかどうかを確定する。 OP におけるエンドユーザの認証方法およびそのような認証に関わるポリシーは全て、本文書の対象範囲外である。
        li: OP は、エンドユーザのユーザエージェントを、 認証が承認されたことを示すアサーション、認証が失敗したことを示すメッセージのどちらかとともに RP へリダイレクトする。
        li: RP は、 OP から受け取った情報を検証し、戻り URL （Return URL） のチェック、ディスカバリによって得られた情報の検証、 ノンス (nonce) のチェックなどを行なう。また、アソシエーション時に確立した共有鍵を用いる、あるいは OP に直接要求を送る、のいずれかの方法で、署名を検証する。
  section_4:
    title: データフォーマット
    content:
    section_4_1:
      title: プロトコルメッセージ
      content: |
        OpenID 認証プロトコルメッセージは、プレーンテキストのキーとプレーンテキストの値とをマッピングしたものである。キーおよび値には、 Unicode 文字セット (UCS) を全て使用することができる。キーおよび値とバイト形式との間の変換が必要な場合は、 UTF-8 [RFC3629] を用いてエンコードしなければならない (MUST) 。
        メッセージは、同じ名前のパラメータを複数含んではならない (MUST NOT) 。
        本文書に記されている OpenID メッセージのパラメータは、全て必須である (REQUIRED) 。ただし、任意である (OPTIONAL) と明示されている場合は、その限りではない。
      section_4_1_1:
        title: キー・値フォームエンコーディング
        content: |
          キー・値形式のメッセージは、一連の行からなる。各行の最初はキーで、その後ろにコロンを付加し、キーと関連する値が続く。各行は、一個の改行文字 ( UCS 文字コード番号 10, "\n") で終わる。キーまたは値は、改行文字を含んではならない （MUST NOT） 。また、キーは、コロンを含んではならない (MUST NOT) 。
          空白を含む追加文字は、コロンまたは改行文字の前後に追加してはならない (MUST NOT)。メッセージからバイト文字列を生成するときは、 UTF-8 でエンコードしなければならない (MUST) 。
          キー・値フォームエンコーディングは、署名計算および RP への直接応答に利用される。